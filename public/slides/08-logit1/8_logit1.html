<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Estadística Multivariada</title>
    <meta charset="utf-8" />
    <meta name="author" content=".small[Juan Carlos Castillo    Departamento de Sociología - UCH / COES   ]" />
    <script src="libs/header-attrs/header-attrs.js"></script>
    <link rel="stylesheet" href="custom_2020.css" type="text/css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.7.0/animate.min.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">

class: front






&lt;!---
Para correr en ATOM
- open terminal, abrir R (simplemente, R y enter)
- rmarkdown::render('static/docpres/07_interacciones/7interacciones.Rmd', 'xaringan::moon_reader') 

About macros.js: permite escalar las imágenes como [scale 50%](path to image), hay si que grabar ese archivo js en el directorio.
---&gt;


.pull-left[
# Estadística Multivariada
## Juan Carlos Castillo
## Sociología FACSO - UChile
## 1er Sem 2021
## [.purple[multivariada.netlify.com]](https://multivariada.netlify.com)
]


.pull-right[
.right[
&lt;br&gt;
## .purple[Sesión 8: Regresión Logística (1)]
![:scale 70%](https://multivariada.netlify.com/img/hex_multiva.png)
&lt;br&gt;


]

]
---

layout: true
class: animated, fadeIn


---
class: inverse, bottom, right, animated, slideInRight


# Contenidos

## 1. Repaso de sesión anterior 

## 2. Introducción a regresión logística


---
class: roja bottom right slideInRight

# 1. Repaso sesión anterior


---
# Conceptos centrales

- población - muestra

- parámetro - estadístico

- **error estándar**: permite expresar un rango de variación probable de un parámetro, con un cierto nivel de probabilidad

---
# Distribución normal

![](../images/normal.png)

---
# Inferencia

- `\(H_0\)`: hipótesis nula (en general: no hay diferencias en la población)

- Establecer un nivel de significación `\(\alpha\)`, convencionalmente 0.05 o inferior para rechazar `\(H_0\)` -&gt; 95% de confianza

- Calcular error estándar 

- Calcular prueba estadística que permita relacionar el error estándar con los niveles de significación

---
# Inferencia en regresión

- Se calcula el error estándar del `\(\beta\)`

- Se divide el `\(\beta\)` por el error estándar -&gt; prueba `\(t\)`

- Se compara el `\(t\)` con el `\(t_{crítico}\)` en la tabla de valores `\(t\)`, asociada a un nivel de confianza y grados de libertad `\(n-k-1\)`

- Si `\(t\)` &gt; `\(t_{crítico}\)` = se rechaza `\(H_0\)` con una probabilidad de error _p_.

---
# Ejemplo:

- ver interpretación paso a paso de tabla de regresión en [Práctica 7](https://multivariada.netlify.app/assignment/07-code/) 

---
class: roja bottom right


# Regresión logística (1)


## Para variables dependientes dicotómicas

---
## Variables

- discretas (Rango finito de valores):

      - Dicotómicas
      - Politómicas

- continuas:

      - Rango (teóricamente) infinito de valores.

---
## Niveles de medición de variables 

- NOIR: Nominal, Ordinal, Intervalar, Razón

.small[
| Tipo       	| Características                     	        | Propiedad de números 	| Ejemplo|
|------------	|----------------------------------------------|---------------	|-----------	|
| *Nominal*    	| Uso de números en lugar de palabras 	| Identidad            	| Nacionalidad      	|
| *Ordinal*    	| Números se usan para ordenar series 	| + ranking            	| Nivel educacional 	|
| *Intervalar* 	| Intervalos iguales entre números    	| + igualdad           	| Temperatura       	|
| *Razón*      	| Cero real                           	| + aditividad         	| Distancia         	|
]

???

  - Nominal: Números empleados como etiquetas (ej. sexo, raza)

  - Ordinales: Distintas categorías puede sen ordenados en serie. Posición, no distancia. (ej. cargos en una empresa)

  - Intervalares: Escalas de unidades iguales. Diferencia entre dos número consecuntivos refleja diferencia empírica. (ej. Horas del día)

  - Razón: caracterizados por la presencia de un cero absoluto. (ej. frecuencias de eventos)

---
## Tipos de datos en relación a escalas de medición.

* *Datos categóricos*: pueden ser medidos sólo mediante escalas nominales, u ordinales en caso de orden de rango

* *Datos continuos*:
    - Medidos en escalas intervalares o de razón
    - Pueden ser transformados a datos categóricos

???
Conversión de continuo a categórico: estatura (cm) a categorías bajo – mediano – alto


---
## Descriptivos según tipo de variable

&lt;br&gt;
.small[
|             	| Categórica                      	| Continua                      	| Categ.(y)/Categ.(x)                    	| Cont.(y)/Categ.(x)                	|
|-------------	|---------------------------------	|-------------------------	|------------------------------------------------	|------------------------------------------	|
| **Ejemplo**     	| **Estatus Ocupacional**             	| **Ingreso**                       	| **Estatus Ocupacional (Y) / Género (X)**           	| **Ingreso (Y) / Género (X)**                 	|
| Tabla       	| Frecuencias / porcentajes                  	| Necesidad de recodificar      	| Tabla de Contingencia                          	| Clasificar Y                             	|
| Gráfico     	| Barras                          	| Histograma / boxplot          	| Gráfico de barras condicionado                 	| Histograma, box plot condicionado        	|
]

---
## Análisis estadístico según tipos de variables

- Variable dependiente (y) : lo que quiero explicar

- Variable independiente (x): lo que me permite explicar la dependiente

.small[
| Variable independiente x 	| Variable dependiente Categórica   	| Variable dependiente Continua        	|
|--------------------------	|-----------------------------------	|--------------------------------------	|
| Categórica               	| Análisis de tabla de Contigencia, Chi2	| Análisis de Varianza ANOVA, Prueba T 	|
| Continua                 	| Regresión Logística 	| Correlación / Regresión Lineal                     	|
]
???


---
class: inverse, center, bottom

.pull-left[
![:scale 80%](../images/postertitanic.jpg)
]

## ¿Se puede anticipar el final?

???

Si vas al cine a ver esta película, y si antes conoces los datos sobre el Titanic, puedes anticipar el final?

---
# Titanic data




.small[

<div class="container st-container">
<table class="table table-striped table-bordered st-table st-table-striped st-table-bordered st-multiline ">
  <thead>
    <tr>
      <th align="center" class="st-protect-top-border"><strong>No</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Variable</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Stats / Values</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Freqs (% of Valid)</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Graph</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Valid</strong></th>
      <th align="center" class="st-protect-top-border"><strong>Missing</strong></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td align="center">1</td>
      <td align="left">survived
[factor]</td>
      <td align="left">1. No sobrevive
2. Sobrevive</td>
      <td align="left" style="padding:0;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">619</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">59.2%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">427</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">40.8%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr></table></td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent"><img style="border:none;background-color:transparent;padding:0" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAGUAAAA3CAQAAAC/M0y4AAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAHdElNRQflBgQOCCPqX5QWAAAAoElEQVRo3u3YywmAMBAA0USszgq0Qq0g7ek1Ch78QCbLzM1L8MFGcPOeojS0fgEpsSlj/bB2d3GWfENJaWr9bo8qp6dAAyaFmBRiUohJISaFmBRiUohJISaF2OXfvrw7BVGulyzdLVxStXCJNGCBKKe7sjWcsDl/PQGy0vvjcxNowKQQk0JMCjEpxKQQk0JMCjEpxKQQi7rS67tAAyaF2AHJKAvhi6O4OQAAACV0RVh0ZGF0ZTpjcmVhdGUAMjAyMS0wNi0wNFQxNDowODozNSswMDowMMCPpvYAAAAldEVYdGRhdGU6bW9kaWZ5ADIwMjEtMDYtMDRUMTQ6MDg6MzUrMDA6MDCx0h5KAAAAAElFTkSuQmCC"></td>
      <td align="center">1046
(100.0%)</td>
      <td align="center">0
(0.0%)</td>
    </tr>
    <tr>
      <td align="center">2</td>
      <td align="left">sex
[factor]</td>
      <td align="left">1. Hombre
2. Mujer</td>
      <td align="left" style="padding:0;vertical-align:middle"><table style="border-collapse:collapse;border:none;margin:0"><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">658</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">62.9%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr><tr style="background-color:transparent"><td style="padding:0 5px 0 7px;margin:0;border:0" align="right">388</td><td style="padding:0 2px 0 0;border:0;" align="left">(</td><td style="padding:0;border:0" align="right">37.1%</td><td style="padding:0 4px 0 2px;border:0" align="left">)</td></tr></table></td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent"><img style="border:none;background-color:transparent;padding:0" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAGsAAAA3CAQAAACh+nwLAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAHdElNRQflBgQOCCR0OwG1AAAAoUlEQVRo3u3YywmAMBAA0USszgq0Qq3A9vQaBUEifmadueUiebDxsHlJEWvevoAsWW15GNEPbcgHrJS6t+9W3bw5BR1CWaRkkZJFShYpWaRkkZJFShYpWaR2u4y57iufK5fLJvTiKRWLp6hDGJS1eVvTw1PY5+vfOMF6dv155+8p6BDKIiWLlCxSskjJIiWLlCxSskjJIvWH9Wecgg6hLFIryPIL4dIA3o8AAAAldEVYdGRhdGU6Y3JlYXRlADIwMjEtMDYtMDRUMTQ6MDg6MzYrMDA6MDDxZ7xrAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIxLTA2LTA0VDE0OjA4OjM2KzAwOjAwgDoE1wAAAABJRU5ErkJggg=="></td>
      <td align="center">1046
(100.0%)</td>
      <td align="center">0
(0.0%)</td>
    </tr>
    <tr>
      <td align="center">3</td>
      <td align="left">age
[numeric]</td>
      <td align="left">Mean (sd) : 29.9 (14.4)
min < med < max:
0.2 < 28 < 80
IQR (CV) : 18 (0.5)</td>
      <td align="left" style="vertical-align:middle">98 distinct values</td>
      <td align="left" style="vertical-align:middle;padding:0;background-color:transparent"><img style="border:none;background-color:transparent;padding:0" src="data:image/png;base64, iVBORw0KGgoAAAANSUhEUgAAAJgAAABuCAQAAABxABKuAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAAmJLR0QA/4ePzL8AAAAHdElNRQflBgQOCCR0OwG1AAABxElEQVR42u3cQW7CMBQAUYI4XU8AJywn6PXabWIXwhAT/+/M26FKCKbYOI7F9HsSce79ArIxGGQw6DJ/0GY+u//zNNep9xvdYv7iL28/yxNfxeOf3u+4IYckZDDIYJDBIINBBoMMBhkMMhhkMMhgkMEgg0Ef2a2olVs+ebd7dgq23PDJvN3jkIQMBhkMMhhkMMhgkMEgg0EGgwwGGQwyGGQwyGCQwaDN+2H3gx2SbbCBOPJpsJpDEjIYZDDIYJDBIINBBoN2upFbqpe7We6FdwqWd7HrkIQMBhkMMhhkMMhgkMEgg0EGgzqt9GtZjg2HCZbl2LBDEjIYZDDIYJDBIINBBoMMBhkMMhgU5tKoFPVGXNhgUW/EOSQhg0EGgwwGhZ30azG+NxMFi/G9uQg23i+wtld8wmL8FyNz0ocMBhkMMhhkMMhgkMEgg0GJLo1qPU78pA7W48SPQxJa/YTF2FSJYzVYfTl+tN8RWHpjDstyVvAzUk/6pT2mj6GCvTJ9bE04VLBa+w1RlxWQwSCDQQaDDAYZDDIYZDBo8IVrbX3r4Pm1wOGClVsHr1xO3WYJp/lfvw+9cfPYw2Ba56QPGQwyGPQHpngzWp7/U8kAAAAldEVYdGRhdGU6Y3JlYXRlADIwMjEtMDYtMDRUMTQ6MDg6MzYrMDA6MDDxZ7xrAAAAJXRFWHRkYXRlOm1vZGlmeQAyMDIxLTA2LTA0VDE0OjA4OjM2KzAwOjAwgDoE1wAAAABJRU5ErkJggg=="></td>
      <td align="center">1046
(100.0%)</td>
      <td align="center">0
(0.0%)</td>
    </tr>
  </tbody>
</table>
<p>Generated by <a href='https://github.com/dcomtois/summarytools'>summarytools</a> 0.9.9 (<a href='https://www.r-project.org/'>R</a> version 4.0.2)<br/>2021-06-04</p>
</div>
]

---
# Sobrevivientes
.pull-left[
.small[


```r
plot1 &lt;-ggplot(tt, 
     aes(survived, fill=survived)) + 
  geom_bar() + 
  geom_text(
     aes(label = scales::percent((..count..)/sum(..count..))),
     stat='count',size=10, vjust = 3) + 
  theme(legend.position="none", 
        text = element_text(size = 30),
        axis.title=element_blank())
```
]
]
.pull-right[
![](8_logit1_files/figure-html/unnamed-chunk-5-1.png)&lt;!-- --&gt;


]



---
# Sexo

.center[
![](8_logit1_files/figure-html/unnamed-chunk-6-1.png)&lt;!-- --&gt;
]
---
## Sobrevivencia / sexo

.pull-left[
![:scale 95%](mosaic.png)
]


.pull-right[
.medium[

```
##               
##                Hombre Mujer
##   No sobrevive   0.79  0.25
##   Sobrevive      0.21  0.75
```
El 75% de las mujeres sobrevive, mientras el 25% no sobrevive.
]
]

---
class: inverse, middle, center

## ¿En qué medida la probabilidad de sobrevivir depende del sexo?

## ¿Es esta probabilidad estadísticamente significativa?

---
# Alternativas:

- tabla de contingencia, `\(\chi^2\)`

  - análisis de tendencia general, significación estadística
  - pero ... poco parsimoniosa, y no hay control estadístico
  
- ¿Aprovechar las ventajas del modelo de regresión?
  - expresar la relación en un número ( `\(\beta\)` )
  - inferencia
  - control estadístico

---
# Regresión

### Modelando la probabilidad de sobrevivir con regresión OLS



.small[

```r
reg_tit=lm(survived ~ sex, data= tt)
```

```
## Warning in model.response(mf, "numeric"): using type = "numeric" with a factor
## response will be ignored
```

```
## Warning in Ops.factor(y, z$residuals): '-' not meaningful for factors
```

]


-&gt; Advertencia de R

---
## Modelo de probabilidad lineal

.pull-left[
.small[
Se da este nombre a los modelos de regresión donde una variable dependiente dicotómica se estima de manera tradicional (mínimos cuadrados ordinarios)


```r
str(tt$survived)
```

```
##  Factor w/ 2 levels "No sobrevive",..: 2 2 1 1 1 2 2 1 2 1 ...
```

```r
tt &lt;- tt %&gt;% mutate(survived_n=recode(survived,
"No sobrevive"=0, "Sobrevive"=1))
str(tt$survived_n)
```

```
##  num [1:1046] 1 1 0 0 0 1 1 0 1 0 ...
```
]
]

.pull-right[
.small[


```r
reg_tit=lm(survived_n ~ sex, data=tt)
```


&lt;table style="border-collapse:collapse; border:none;"&gt;
&lt;tr&gt;
&lt;th style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm;  text-align:left; "&gt;&amp;nbsp;&lt;/th&gt;
&lt;th colspan="2" style="border-top: double; text-align:center; font-style:normal; font-weight:bold; padding:0.2cm; "&gt;Modelo 1&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  text-align:left; "&gt;Predictores&lt;/td&gt;
&lt;td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  "&gt;β&lt;/td&gt;
&lt;td style=" text-align:center; border-bottom:1px solid; font-style:italic; font-weight:normal;  "&gt;std. Error&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; "&gt;(Intercept)&lt;/td&gt;
&lt;td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "&gt;0.205 &lt;sup&gt;***&lt;/sup&gt;&lt;/td&gt;
&lt;td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "&gt;0.016&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; "&gt;sex [Mujer]&lt;/td&gt;
&lt;td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "&gt;0.547 &lt;sup&gt;***&lt;/sup&gt;&lt;/td&gt;
&lt;td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:center;  "&gt;0.027&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm; border-top:1px solid;"&gt;Observations&lt;/td&gt;
&lt;td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left; border-top:1px solid;" colspan="2"&gt;1046&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td style=" padding:0.2cm; text-align:left; vertical-align:top; text-align:left; padding-top:0.1cm; padding-bottom:0.1cm;"&gt;R&lt;sup&gt;2&lt;/sup&gt; / R&lt;sup&gt;2&lt;/sup&gt; adjusted&lt;/td&gt;
&lt;td style=" padding:0.2cm; text-align:left; vertical-align:top; padding-top:0.1cm; padding-bottom:0.1cm; text-align:left;" colspan="2"&gt;0.289 / 0.289&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td colspan="3" style="font-style:italic; border-top:double black; text-align:right;"&gt;* p&amp;lt;0.05&amp;nbsp;&amp;nbsp;&amp;nbsp;** p&amp;lt;0.01&amp;nbsp;&amp;nbsp;&amp;nbsp;*** p&amp;lt;0.001&lt;/td&gt;
&lt;/tr&gt;

&lt;/table&gt;
]
]

---
## Significado coeficientes modelo probabilidad lineal

.pull-left[
**Promedio de supervivencia por sexo**
&lt;!-- html table generated in R 4.0.2 by xtable 1.8-4 package --&gt;
&lt;!-- Fri Jun  4 10:08:36 2021 --&gt;
&lt;table border=1&gt;
&lt;tr&gt; &lt;th&gt;  &lt;/th&gt; &lt;th&gt; Mean &lt;/th&gt; &lt;th&gt; N &lt;/th&gt; &lt;th&gt; Std. Dev. &lt;/th&gt;  &lt;/tr&gt;
  &lt;tr&gt; &lt;td&gt; Hombre &lt;/td&gt; &lt;td align="right"&gt; 0.21 &lt;/td&gt; &lt;td align="right"&gt; 658 &lt;/td&gt; &lt;td align="right"&gt; 0.40 &lt;/td&gt; &lt;/tr&gt;
  &lt;tr&gt; &lt;td&gt; Mujer &lt;/td&gt; &lt;td align="right"&gt; 0.75 &lt;/td&gt; &lt;td align="right"&gt; 388 &lt;/td&gt; &lt;td align="right"&gt; 0.43 &lt;/td&gt; &lt;/tr&gt;
  &lt;tr&gt; &lt;td&gt; Total &lt;/td&gt; &lt;td align="right"&gt; 0.41 &lt;/td&gt; &lt;td align="right"&gt; 1046 &lt;/td&gt; &lt;td align="right"&gt; 0.49 &lt;/td&gt; &lt;/tr&gt;
   &lt;/table&gt;
]

.pull-right[
- El valor del intercepto=0.205 (0.21 aproximado) es el valor predicho para la categoría de referencia "hombre".

- El `\(\beta\)` de sexo (mujer) =0.547 sumado al intercepto equivale al porcentaje de supervivencia de mujeres]

---
class: roja, middle

# funciona ... .yellow[PERO]

---
## Limitaciones modelo de regresión lineal para dependientes dicotómicas

.center[
![](8_logit1_files/figure-html/unnamed-chunk-14-1.png)&lt;!-- --&gt;
]

---
## Problemas ....
.center[
![](8_logit1_files/figure-html/unnamed-chunk-15-1.png)&lt;!-- --&gt;
]

---
# Problemas ...

.pull-left[
Si hubieran sobrevivido todos los menores de 20 y muerto todos los mayores de 40 ...

]

.pull-right[
![](8_logit1_files/figure-html/unnamed-chunk-17-1.png)&lt;!-- --&gt;
]


---
class: inverse

## Problemas regresión tradicional (OLS) para dependientes dicotómicas

- ### Eventuales predicciones fuera del rango de probabilidades posibles
- ### Ajuste a los datos / residuos: ¿Es la mejor aproximación una recta?

---
class: roja, right

## La regresión .yellow[logística] ofrece una solución a los problemas del rango de predicciones y de ajuste a los datos del modelo de probabilidad lineal

--

## Se logra mediante una _transformación_ de lo(s) beta(s)  a .yellow[coeficientes  *LOGIT*]
]

---
class: middle center
![:scale 90%](bending.png)

---
## OLS vs Logit

.pull-left[
![](8_logit1_files/figure-html/unnamed-chunk-18-1.png)&lt;!-- --&gt;
]

.pull-right[



![](8_logit1_files/figure-html/unnamed-chunk-20-1.png)&lt;!-- --&gt;
]


---
# ¿Qué es el logit?

--


## Es el logaritmo de los odds

--

# ... qué son los odds?

--

## Una razón de *probabilidades*


--
## Para llegar hasta regresión logística, hay que pasar por los odds (chances), y los odds-ratio (proporción de chances)

---
# Odds 

- **odds** (chances): probabilidad de que algo ocurra dividido por la probabilidad de que no ocurra

`$$Odds=\frac{p}{1-p}$$`

--

.medium[
Ej. Titanic:
  - 427 sobrevivientes (41%), 619 muertos (59%)
`$$Odds_{sobrevivir}=427/619=0.41/0.59=0.69$$`

**Es decir, las chances de sobrevivir son de 0.69**]
---
# Odds

- Odds de 1 significan chances iguales, menores a 1 son negativas y mayores a 1 son positivas

- _Propiedad simétrica_: 
  - un `\(Odd=4\)` es una asociación positiva proporcional a la asociación negativa `\(Odd=1/4=0.25\)`

---
.pull-left[
## Odds de superviviencia para los hombres
.medium[

```
##               
##                Hombre Mujer
##   No sobrevive    523    96
##   Sobrevive       135   292
```
]

.medium[

```
##               
##                Hombre Mujer
##   No sobrevive   0.79  0.25
##   Sobrevive      0.21  0.75
```
El 21% de los hombres sobrevive mientras el 79% no sobrevive.
]
]
--
.pull-right[
.medium[

`$$Odds_{hombres}=\frac{0.21}{0.79}=0.27$$`

*La probabilidad de sobrevivencia en los hombres es 0.27 veces a la no sobrevivencia*

... o en otros términos

*Hay 0.27 hombres que sobreviven por cada uno que no sobrevive*

*Hay 27 hombres que sobreviven por cada 100 hombres que no sobreviven*
]
]

---
## Odds de superviviencia para las mujeres

.pull-left[
.medium[

```
##               
##                Hombre Mujer
##   No sobrevive   0.79  0.25
##   Sobrevive      0.21  0.75
```
El 75% de las mujeres sobrevive, mientras el 25% no sobrevive.


]
]
--
.pull-right[
.medium[
`$$Odds_{mujeres}=\frac{0.75}{0.25}=3$$`
*La probabilidad de sobrevivencia en las mujeres es 3 veces a la no sobrevivencia*


*Hay 3 mujeres que sobreviven por cada mujer que no sobrevive*

o en otros términos

*Hay 300 mujeres que sobreviven al titanic por cada 100 mujeres que no sobreviven*
]
]


---
## Odds ratio (OR)

.pull-left[
- los odds-ratio (o razón de chances) permiten reflejar la asociación entre las chances de dos variables dicotómicas


**¿Tienen las mujeres más chances de sobrevivir que los hombres?**
]

--
.pull-right[
.medium[
&lt;table style="border-collapse:collapse; border:none;"&gt;
 &lt;tr&gt;
 &lt;th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; border-bottom:1px solid;" rowspan="2"&gt;survived&lt;/th&gt;
 &lt;th style="border-top:double; text-align:center; font-style:italic; font-weight:normal;" colspan="2"&gt;sex&lt;/th&gt;
 &lt;th style="border-top:double; text-align:center; font-style:italic; font-weight:normal; font-weight:bolder; font-style:italic; border-bottom:1px solid; " rowspan="2"&gt;Total&lt;/th&gt;
 &lt;/tr&gt;
 
&lt;tr&gt;
 &lt;td style="border-bottom:1px solid; text-align:center; padding:0.2cm;"&gt;Hombre&lt;/td&gt;
 &lt;td style="border-bottom:1px solid; text-align:center; padding:0.2cm;"&gt;Mujer&lt;/td&gt;
 &lt;/tr&gt;
 
&lt;tr&gt; 
&lt;td style="padding:0.2cm;  text-align:left; vertical-align:middle;"&gt;No sobrevive&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:center; "&gt;&lt;span style="color:black;"&gt;523&lt;/span&gt;&lt;br&gt;&lt;span style="color:#339933;"&gt;79.5&amp;nbsp;&amp;#37;&lt;/span&gt;&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:center; "&gt;&lt;span style="color:black;"&gt;96&lt;/span&gt;&lt;br&gt;&lt;span style="color:#339933;"&gt;24.7&amp;nbsp;&amp;#37;&lt;/span&gt;&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:center;  "&gt;&lt;span style="color:black;"&gt;619&lt;/span&gt;&lt;br&gt;&lt;span style="color:#339933;"&gt;59.2&amp;nbsp;&amp;#37;&lt;/span&gt;&lt;/td&gt; 
&lt;/tr&gt;
 
&lt;tr&gt; 
&lt;td style="padding:0.2cm;  text-align:left; vertical-align:middle;"&gt;Sobrevive&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:center; "&gt;&lt;span style="color:black;"&gt;135&lt;/span&gt;&lt;br&gt;&lt;span style="color:#339933;"&gt;20.5&amp;nbsp;&amp;#37;&lt;/span&gt;&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:center; "&gt;&lt;span style="color:black;"&gt;292&lt;/span&gt;&lt;br&gt;&lt;span style="color:#339933;"&gt;75.3&amp;nbsp;&amp;#37;&lt;/span&gt;&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:center;  "&gt;&lt;span style="color:black;"&gt;427&lt;/span&gt;&lt;br&gt;&lt;span style="color:#339933;"&gt;40.8&amp;nbsp;&amp;#37;&lt;/span&gt;&lt;/td&gt; 
&lt;/tr&gt;
 
&lt;tr&gt; 
&lt;td style="padding:0.2cm;  border-bottom:double; font-weight:bolder; font-style:italic; text-align:left; vertical-align:middle;"&gt;Total&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:center;   border-bottom:double;"&gt;&lt;span style="color:black;"&gt;658&lt;/span&gt;&lt;br&gt;&lt;span style="color:#339933;"&gt;100&amp;nbsp;&amp;#37;&lt;/span&gt;&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:center;   border-bottom:double;"&gt;&lt;span style="color:black;"&gt;388&lt;/span&gt;&lt;br&gt;&lt;span style="color:#339933;"&gt;100&amp;nbsp;&amp;#37;&lt;/span&gt;&lt;/td&gt;
&lt;td style="padding:0.2cm; text-align:center;   border-bottom:double;"&gt;&lt;span style="color:black;"&gt;1046&lt;/span&gt;&lt;br&gt;&lt;span style="color:#339933;"&gt;100&amp;nbsp;&amp;#37;&lt;/span&gt;&lt;/td&gt; 
&lt;/tr&gt;
 
&lt;/table&gt;
]
]

---
# Odds Ratio

**¿Cuantas más chances de sobrevivir tienen las mujeres respecto de los hombres?**

- OR supervivencia mujeres / OR supervivencia hombres

.medium[
`$$OR=\frac{p_{m}/(1-p_{m})}{p_{h}/(1-p_{h})}=\frac{0.753/(1-0.753)}{0.205/(1-0.205)}=\frac{3.032}{0.257}=11.78$$`
]

--

### Las chances de sobrevivir de las mujeres son **11.78** veces más que las de los hombres.

---
class: inverse, middle, center

## El Odds-Ratio (OR) nos permite expresar **en un número** la relación entre dos variables categóricas

## Por lo tanto, es una versión del `\(\beta\)` para dependientes categóricas


---
class: inverse, middle, center

## Pero ... el **OR** tiene algunas limitaciones que requieren una transformación adicional, tema de la .yellow[próxima clase] 



---
class: inverse

## Resumen

- limitaciones de OLS para dependientes dicotómicas

- requiere de ajustes y transformaciones para que la estimación tenga sentido

- regresión logística: ajusta el modelo para dependientes dicotómicas

- pasa por el cálculo de los odds-ratio, que resumen en 1 número la relación entre dos variables categóricas

---
# Próxima semana

- logit

- estimación e interpretación regresión logística

- ajuste regresión logística

---
class: front

.pull-left[
# Estadística Multivariada
## Juan Carlos Castillo
## Sociología FACSO - UChile
## 1er Sem 2021
## [multivariada.netlify.com](https://multivariada.netlify.com)
]


.pull-right[
.right[
&lt;br&gt;
![:scale 80%](https://multivariada.netlify.com/img/hex_multiva.png)
]

]
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script src="https://multinivel.netlify.com/docpres/xaringan_custom/macros.js"></script>
<script>var slideshow = remark.create({
"ratio": "16:9",
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>
<style>
.logo {
  background-image: url("../hex_multiva_white.png");
  background-size: contain;
  background-repeat: no-repeat;
  position: absolute;
  top: 16.3em;
  right: 31em;
  width: 110px;
  height: 70px;
  z-index: 0;
}
</style>

<script>
document
  .querySelectorAll(
    '.remark-slide-content' +
    ':not(.title-slide)' +
    // add additional classes to exclude here, e.g.
    // ':not(.inverse)' +
    ':not(.hide-logo)'
  )
  .forEach(el => {
    el.innerHTML += '<div class="logo"></div>';
  });
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
